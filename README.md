# Week-4-day-4-assignment-
My assignment for week 4 day 4 
Assignment Questions
Customer Analysis - using Bills Table
Identify the top 5 customers with the highest total bill amount.

SELECT customerID, SUM(TotalAmount) as TotalSpending
FROM Bills
GROUP BY customerID
ORDER BY TotalSpending DESC
LIMIT 5;

Determine the average time taken to pay a bill for each customer.
SELECT customerID, AVG(DATEDIFF(PaymentDate, BillDate)) as AvgPaymentTime
FROM Bills
WHERE PaymentDate IS NOT NULL 
GROUP BY customerID;

Find customers who have never made a late payment
SELECT DISTINCT customerID
FROM Bills
WHERE PaymentDate <= DueDate;


Bill Analysis - using Bill_Items Table
Calculate the total amount generated.

SELECT SUM(LineTotal) as TotalRevenue
FROM Bill_Items;

Identify the item with the highest LineTotal column.
SELECT itemDescription
FROM Bill_Items
WHERE LineTotal = (SELECT MAX(LineTotal) FROM Bill_Items);

Which item had the minimum LineTotal column?
SELECT itemDescription
FROM Bill_Items
WHERE LineTotal = (SELECT MIN(LineTotal) FROM Bill_Items);

Payment Analysis - using Payment Table
Find the most popular payment method.
Calculate the total revenue generated by each payment method.
SELECT PaymentMethod, SUM(PaymentAmount) as TotalRevenue
FROM Payments
GROUP BY PaymentMethod;

Determine the average payment amount.
Data Analysis and Insights - using Bills Table

SELECT AVG(PaymentAmount) as AvgPaymentAmount
FROM Payments;

Identify the top 3 categories with the highest total revenue.
SELECT CategoryID, SUM(TotalAmount) as TotalRevenue
FROM Bills
GROUP BY CategoryID
ORDER BY TotalRevenue DESC
LIMIT 3;

Find the customer with the highest number of unpaid bills.

SELECT customerID, COUNT(*) as UnpaidBills
FROM Bills
WHERE status = 'unpaid'
GROUP BY customerID
ORDER BY UnpaidBills DESC
LIMIT 1;
